function [nqptv,wtq,sfac,dndxi,dndet,nqpts,swt,ssfac,dnds] = shafac(meltyp,nnpe,nnps)% initialize the shape function arraysif(meltyp==9)      nqptv=9;      qpt(1)=0.1127016653793;                                                 qpt(2)=0.50;                                                            qpt(3)=1.0-qpt(1);                                                      wt(1)=0.5555555555556/2.;                                               wt(2)=0.8888888888889/2.;                                               wt(3)=wt(1);                                                       end  if(meltyp==8)      nqptv=9;      qpt(1)=0.1127016653793;                                                 qpt(2)=0.50;                                                            qpt(3)=1.0-qpt(1);                                                      wt(1)=0.5555555555556/2.;                                               wt(2)=0.8888888888889/2.;                                               wt(3)=wt(1);                                                       endif(meltyp==6)      nqptv=7;		  a1=.05971587178977;      b1=.47014206410512;      c1=.79742698535309;      d1=.10128650732346;      qpt(1,1)=0.33333333333333;      qpt(1,2)=0.33333333333333;      qpt(2,1)=a1;      qpt(2,2)=b1;      qpt(3,1)=b1;      qpt(3,2)=a1;      qpt(4,1)=b1;      qpt(4,2)=b1;      qpt(5,1)=c1;      qpt(5,2)=d1;      qpt(6,1)=d1;      qpt(6,2)=c1;      qpt(7,1)=d1;      qpt(7,2)=d1;      wt(1)=0.1125;      wt(2)=0.06619707639425;      wt(3)=wt(2);      wt(4)=wt(2);      wt(5)=0.06296959027241;      wt(6)=wt(5);      wt(7)=wt(5);endif(meltyp==4)      nqptv=4;      qploc=1.0/sqrt(3.0);      qpt(1)=(1.0-qploc)/2.0;                                                 qpt(2)=(1.0+qploc)/2.0;      wt(1)=0.5;                                               wt(2)=0.5;                                         endif(meltyp==3)      nqptv=3;	      qpt(1,1)=0.5;      qpt(1,2)=0.0;      qpt(2,1)=0.0;      qpt(2,2)=0.5;      qpt(3,1)=0.5;      qpt(3,2)=0.5;      wt(1)=0.33333333333333;      wt(2)=wt(1);      wt(3)=wt(1);end  dndet = zeros(nnpe,nqptv);dndxi = zeros(nnpe,nqptv);sfac  = zeros(nnpe,nqptv);wtq = zeros(nqptv,1);    if (meltyp==9)		     for  i=1:1:nnpe                                                        for  j=1:1:nqptv		 		       switch j									case 1     			 j1=1;     			 j2=1;				case 2     			 j1=2;     			 j2=1; 				case 3      			j1=3;      			j2=1;				case 4      			j1=1;     			j2=2;				case 5      			j1=2;      			j2=2;				case 6      			j1=3;      			j2=2;				case 7      			j1=1;      			j2=3;				case 8      			j1=2;      			j2=3; 				case 9     			j1=3;      			j2=3;				end                                                        q1=qpt(j1);                                                              q2=qpt(j2);                                                              sfac(i,j)=sfn(q1,q2,i,meltyp);                                                  dndxi(i,j)=fxi(q1,q2,i,meltyp);                                                 dndet(i,j)=fet(q1,q2,i,meltyp);                                                 wtq(j)=wt(j1)*wt(j2);     end    endend if (meltyp==8)		     for  i=1:1:nnpe                                                        for  j=1:1:nqptv		 		      switch j									case 1     			 j1=1;     			 j2=1;				case 2     			 j1=2;     			 j2=1; 				case 3      			j1=3;      			j2=1;				case 4      			j1=1;     			j2=2;				case 5      			j1=2;      			j2=2;				case 6      			j1=3;      			j2=2;				case 7      			j1=1;      			j2=3;				case 8      			j1=2;      			j2=3; 				case 9     			j1=3;      			j2=3;				end                                                        q1=qpt(j1);                                                              q2=qpt(j2);                                                              sfac(i,j)=sfn(q1,q2,i,meltyp);                                                  dndxi(i,j)=fxi(q1,q2,i,meltyp);                                                 dndet(i,j)=fet(q1,q2,i,meltyp);                                                 wtq(j)=wt(j1)*wt(j2);	       end    endendif(meltyp==6)	   for i=1:1:nnpe                                                        for  j=1:1:nqptv                                                        q1=qpt(j,1);                                                             q2=qpt(j,2);                                                             sfac(i,j)=sfn(q1,q2,i,meltyp);                                                  dndxi(i,j)=fxi(q1,q2,i,meltyp);                                                 dndet(i,j)=fet(q1,q2,i,meltyp);                                                 wtq(j)=wt(j);      end   end  endif(meltyp==4)	   for i=1:1:nnpe                                                        for  j=1:1:nqptv 		 switch j		 		case 1     			 j1=1;     			 j2=1;				case 2     			 j1=2;     			 j2=1; 				case 3%       			j1=1;%       			j2=2;                j1=2;                j2=2;				case 4%       			j1=2;%      			j2=2;                j1=1;                j2=2;           end                                                        q1=qpt(j1);                                                             q2=qpt(j2);                                                             sfac(i,j)=sfn(q1,q2,i,meltyp);                                                  dndxi(i,j)=fxi(q1,q2,i,meltyp);                                                 dndet(i,j)=fet(q1,q2,i,meltyp);                                                 wtq(j)=wt(j1)*wt(j2);      end   end  endif(meltyp==3)	   for i=1:1:nnpe                                                        for  j=1:1:nqptv                                                        q1=qpt(j,1);                                                             q2=qpt(j,2);                                                             sfac(i,j)=sfn(q1,q2,i,meltyp);                                                  dndxi(i,j)=fxi(q1,q2,i,meltyp);                                                 dndet(i,j)=fet(q1,q2,i,meltyp);                                                 wtq(j)=wt(j);      end   end  endif(meltyp==6)	  nqpts=5;      qpts(1)=.046910077030668;                                                qpts(2)=.230765344947158;                                                qpts(3)=.5000;                                                           qpts(4)=1.0-qpts(2);                                                      qpts(5)=1.0-qpts(1);                                                     swt(1)=.118463442522810;                                                swt(2)=.239314335249683;                                                 swt(3)=.284444444444444;                                                 swt(4)=swt(2);                                                          swt(5)=swt(1);	  endif(meltyp==8)	  nqpts=5;      qpts(1)=.046910077030668;                                                qpts(2)=.230765344947158;                                                qpts(3)=.5000;                                                           qpts(4)=1.0-qpts(2);                                                      qpts(5)=1.0-qpts(1);                                                     swt(1)=.118463442522810;                                                swt(2)=.239314335249683;                                                 swt(3)=.284444444444444;                                                 swt(4)=swt(2);                                                          swt(5)=swt(1);	  endif(meltyp==9)	  nqpts=5;      qpts(1)=.046910077030668;                                                qpts(2)=.230765344947158;                                                qpts(3)=.5000;                                                           qpts(4)=1.0-qpts(2);                                                      qpts(5)=1.0-qpts(1);                                                     swt(1)=.118463442522810;                                                swt(2)=.239314335249683;                                                 swt(3)=.284444444444444;                                                 swt(4)=swt(2);                                                          swt(5)=swt(1);	  end	  if(meltyp==4)	  nqpts=3;      qploc=sqrt(3.0/5.0);      qpts(1)=(1.0-qploc)/2.0;      qpts(2)=0.5;      qpts(3)=(1.0+qploc)/2.0;      swt(1)=5.0/18.0;      swt(2)=8.0/18.0;      swt(3)=5.0/18.0;	    end    	  if(meltyp==3)	  nqpts=2;      qploc=1.0/sqrt(3.0);      qpts(1)=(1.0-qploc)/2.0;      qpts(2)=(1.0+qploc)/2.0;      swt(1)=0.5;      swt(2)=0.5;	    end  ssfac  = zeros(nnps,nqpts);  dnds   = zeros(nnps,nqpts);for  i=1:1:nnps 	for  j=1:1:nqpts                                                       ssfac(i,j)=ssfn(qpts(j),i,meltyp);                                              dnds(i,j) =ssxi(qpts(j),i,meltyp);     endend