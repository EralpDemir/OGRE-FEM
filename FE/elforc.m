function [fe] = elforc(dof,nnpe,nqptv,wtq,sfac,detj,uvwth_e)% computes elemental force matrix for body forcesiend1 =   nnpe*dof;sfac_onedof    = zeros(1,nnpe);sfac_fourdof    = zeros(dof,iend1);qp_uvwth      = zeros(dof,1);fe      = zeros(iend1,1);                                                               for   k=1:1:nqptv           xkfac= wtq(k)*detj(k);       qp_uvwth(1) = uvwth_e(1,k);       qp_uvwth(2) = uvwth_e(2,k);       qp_uvwth(3) = uvwth_e(3,k);       qp_uvwth(4) = uvwth_e(4,k);                                                                          for  i=1:1:nnpe       sfac_onedof(i)  = sfac(i,k);  end    for  i=1:1:dof       for j = 1:1:nnpe          j1=(i-1)*nnpe+j;       sfac_fourdof(i,j1)  = sfac_onedof(j);      end  end       fe       = fe  + xkfac*sfac_fourdof'*qp_uvwth;   end